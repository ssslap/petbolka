{% extends "base.html" %}

{% block title %}“ö–∞–±—ã–ª–¥–∞—É“ì–∞ –∂–∞–∑—ã–ª—É - {{ clinic.name }}{% endblock %}

{% block content %}
<!-- Page Header -->
<section class="page-header">
    <div class="container">
        <h1>“ö–∞–±—ã–ª–¥–∞—É“ì–∞ –∂–∞–∑—ã–ª—É</h1>
        <p>–ö–ª–∏–Ω–∏–∫–∞–º—ã–∑“ì–∞ –∫–µ–ª—É “Ø—à—ñ–Ω —ã“£“ì–∞–π–ª—ã —É–∞“õ—ã—Ç—Ç—ã —Ç–∞“£–¥–∞“£—ã–∑</p>
    </div>
</section>

<!-- Appointment Form -->
<section class="appointment-section section">
    <div class="container">
        <div class="appointment-grid">
            <!-- Form -->
            <div class="appointment-form-wrapper">
                <form class="appointment-form" id="appointmentForm">
                    <h2>“Æ–π –∂–∞–Ω—É–∞—Ä—ã —Ç—É—Ä–∞–ª—ã –º”ô–ª—ñ–º–µ—Ç—Ç–µ—Ä</h2>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="pet_name">“Æ–π –∂–∞–Ω—É–∞—Ä—ã–Ω—ã“£ –∞—Ç—ã *</label>
                            <input type="text" id="pet_name" name="pet_name" required placeholder="–ê—Ç—ã–Ω –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑">
                        </div>
                        
                        <div class="form-group">
                            <label for="pet_type">–ñ–∞–Ω—É–∞—Ä —Ç“Ø—Ä—ñ *</label>
                            <select id="pet_type" name="pet_type" required>
                                <option value="">–¢“Ø—Ä—ñ–Ω —Ç–∞“£–¥–∞“£—ã–∑</option>
                                <option value="dog">–ò—Ç</option>
                                <option value="cat">–ú—ã—Å—ã“õ</option>
                                <option value="bird">“ö“±—Å</option>
                                <option value="rodent">–ö–µ–º—ñ—Ä–≥—ñ—à</option>
                                <option value="reptile">–ë–∞—É—ã—Ä—ã–º–µ–Ω –∂–æ—Ä“ì–∞–ª–∞—É—à—ã</option>
                                <option value="other">–ë–∞—Å“õ–∞</option>
                            </select>
                        </div>
                    </div>

                    <h2>–°—ñ–∑–¥—ñ“£ –º”ô–ª—ñ–º–µ—Ç—Ç–µ—Ä—ñ“£—ñ–∑</h2>
                    
                    <div class="form-group">
                        <label for="owner_name">–°—ñ–∑–¥—ñ“£ –∞—Ç—ã“£—ã–∑ *</label>
                        <input type="text" id="owner_name" name="owner_name" required placeholder="–ê—Ç—ã“£—ã–∑–¥—ã –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑">
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="owner_email">Email *</label>
                            <input type="email" id="owner_email" name="owner_email" required placeholder="Email –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑">
                        </div>
                        
                        <div class="form-group">
                            <label for="owner_phone">–¢–µ–ª–µ—Ñ–æ–Ω *</label>
                            <input type="tel" id="owner_phone" name="owner_phone" required placeholder="+7 (___) ___-__-__">
                        </div>
                    </div>

                    <h2>“ö–∞–±—ã–ª–¥–∞—É –º”ô–ª—ñ–º–µ—Ç—Ç–µ—Ä—ñ</h2>
                    
                    <div class="form-group">
                        <label for="doctor_id">–î”ô—Ä—ñ–≥–µ—Ä–¥—ñ —Ç–∞“£–¥–∞“£—ã–∑ *</label>
                        <select id="doctor_id" name="doctor_id" required>
                            <option value="">–î”ô—Ä—ñ–≥–µ—Ä–¥—ñ —Ç–∞“£–¥–∞“£—ã–∑</option>
                            {% for doctor in doctors %}
                            <option value="{{ doctor.id }}">{{ doctor.name }} - {{ doctor.specialization }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="appointment_date">“ö–∞–±—ã–ª–¥–∞—É –∫“Ø–Ω—ñ *</label>
                            <input type="date" id="appointment_date" name="appointment_date" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="appointment_time">“ö–∞–±—ã–ª–¥–∞—É —É–∞“õ—ã—Ç—ã *</label>
                            <select id="appointment_time" name="appointment_time" required>
                                <option value="">–£–∞“õ—ã—Ç—Ç—ã —Ç–∞“£–¥–∞“£—ã–∑</option>
                                <option value="09:00">09:00</option>
                                <option value="09:30">09:30</option>
                                <option value="10:00">10:00</option>
                                <option value="10:30">10:30</option>
                                <option value="11:00">11:00</option>
                                <option value="11:30">11:30</option>
                                <option value="12:00">12:00</option>
                                <option value="12:30">12:30</option>
                                <option value="14:00">14:00</option>
                                <option value="14:30">14:30</option>
                                <option value="15:00">15:00</option>
                                <option value="15:30">15:30</option>
                                <option value="16:00">16:00</option>
                                <option value="16:30">16:30</option>
                                <option value="17:00">17:00</option>
                                <option value="17:30">17:30</option>
                                <option value="18:00">18:00</option>
                                <option value="18:30">18:30</option>
                                <option value="19:00">19:00</option>
                                <option value="19:30">19:30</option>
                                <option value="20:00">20:00</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="service">“ö—ã–∑–º–µ—Ç</label>
                        <select id="service" name="service">
                            <option value="">“ö—ã–∑–º–µ—Ç—Ç—ñ —Ç–∞“£–¥–∞“£—ã–∑ (–º—ñ–Ω–¥–µ—Ç—Ç—ñ –µ–º–µ—Å)</option>
                            {% for service in services %}
                            <option value="{{ service.id }}">{{ service.name }} - {{ service.price | int }} ‚Ç∏</option>
                            {% endfor %}
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="notes">“ö–æ—Å—ã–º—à–∞ –∞“õ–ø–∞—Ä–∞—Ç</label>
                        <textarea id="notes" name="notes" rows="4" placeholder="–ñ“Ø–≥—ñ–Ω—É —Å–µ–±–µ–±—ñ–Ω —Å–∏–ø–∞—Ç—Ç–∞“£—ã–∑ –Ω–µ–º–µ—Å–µ “õ–æ—Å—ã–º—à–∞ –∞“õ–ø–∞—Ä–∞—Ç—Ç—ã –∫”©—Ä—Å–µ—Ç—ñ“£—ñ–∑"></textarea>
                    </div>
                    
                    <div class="form-group checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" required>
                            <span>–ú–µ–Ω <a href="#">“õ“±–ø–∏—è–ª—ã–ª—ã“õ —Å–∞—è—Å–∞—Ç—ã–º–µ–Ω</a> –∫–µ–ª—ñ—Å–µ–º—ñ–Ω</span>
                        </label>
                    </div>
                    
                    <button type="submit" class="btn btn-primary btn-lg btn-block">“ö–∞–±—ã–ª–¥–∞—É“ì–∞ –∂–∞–∑—ã–ª—É</button>
                </form>
                
                <div id="appointmentMessage" class="form-message" style="display: none;"></div>
            </div>

            <!-- Info Sidebar -->
            <div class="appointment-info">
                <div class="info-box">
                    <h3>üìû –®“±“ì—ã–ª –∂–∞–∑—ã–ª—É</h3>
                    <p>–ï–≥–µ—Ä —Å—ñ–∑–≥–µ —à“±“ì—ã–ª –∫–µ“£–µ—Å “õ–∞–∂–µ—Ç –±–æ–ª—Å–∞, –±—ñ–∑–≥–µ “õ–æ“£—ã—Ä–∞—É —à–∞–ª—ã“£—ã–∑:</p>
                    <a href="tel:{{ clinic.phone }}" class="phone-link">{{ clinic.phone }}</a>
                </div>
                
                <div class="info-box">
                    <h3>üïê –ñ“±–º—ã—Å —É–∞“õ—ã—Ç—ã</h3>
                    <p>{{ clinic.working_hours }}</p>
                </div>
                
                <div class="info-box">
                    <h3>üìç –ú–µ–∫–µ–Ω–∂–∞–π</h3>
                    <p>{{ clinic.address }}</p>
                </div>
                
                <div class="info-box">
                    <h3>‚ÑπÔ∏è –ú–∞“£—ã–∑–¥—ã</h3>
                    <ul>
                        <li>–ë–µ–ª–≥—ñ–ª–µ–Ω–≥–µ–Ω —É–∞“õ—ã—Ç—Ç–∞–Ω 10 –º–∏–Ω—É—Ç –±“±—Ä—ã–Ω –∫–µ–ª—ñ“£—ñ–∑</li>
                        <li>“Æ–π –∂–∞–Ω—É–∞—Ä—ã“£—ã–∑–¥—ã“£ –≤–µ—Ç–µ—Ä–∏–Ω–∞—Ä–∏—è–ª—ã“õ –ø–∞—Å–ø–æ—Ä—Ç—ã–Ω –∞–ª—ã–ø –∫–µ–ª—ñ“£—ñ–∑</li>
                        <li>–ñ–∞–∑—ã–ª—É–¥—ã –±–∞—Å —Ç–∞—Ä—Ç“õ–∞–Ω–¥–∞ –∞–ª–¥—ã–Ω –∞–ª–∞ —Ö–∞–±–∞—Ä–ª–∞“£—ã–∑</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block scripts %}
<script>
// –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –¥–∞—Ç—ã –Ω–∞ —Å–µ–≥–æ–¥–Ω—è
document.getElementById('appointment_date').min = new Date().toISOString().split('T')[0];

// –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ doctor –∏–∑ URL
const urlParams = new URLSearchParams(window.location.search);
const doctorId = urlParams.get('doctor');
if (doctorId) {
    document.getElementById('doctor_id').value = doctorId;
}

// –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º—ã
document.getElementById('appointmentForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const formMessage = document.getElementById('appointmentMessage');
    const doctorSelect = document.getElementById('doctor_id');
    const doctorName = doctorSelect.options[doctorSelect.selectedIndex].text.split(' - ')[0];
    const date = document.getElementById('appointment_date').value;
    const time = document.getElementById('appointment_time').value;
    
    // –î–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–∞–π—Ç–∞ - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–π –∑–∞–ø–∏—Å–∏
    formMessage.className = 'form-message success';
    formMessage.innerHTML = `
        <h3>‚úÖ –ñ–∞–∑—ã–ª—É —Ä–∞—Å—Ç–∞–ª–¥—ã!</h3>
        <p>–°—ñ–∑ <strong>${doctorName}</strong> –¥”ô—Ä—ñ–≥–µ—Ä–≥–µ “õ–∞–±—ã–ª–¥–∞—É“ì–∞ –∂–∞–∑—ã–ª–¥—ã“£—ã–∑</p>
        <p>–ö“Ø–Ω—ñ: <strong>${date}</strong>, —É–∞“õ—ã—Ç—ã: <strong>${time}</strong></p>
        <p>–ë—ñ–∑ —Å—ñ–∑–≥–µ –∫”©—Ä—Å–µ—Ç—ñ–ª–≥–µ–Ω email-–≥–µ –µ—Å–∫–µ —Å–∞–ª—É –∂—ñ–±–µ—Ä–µ–º—ñ–∑.</p>
    `;
    formMessage.style.display = 'block';
    
    // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ —Å–æ–æ–±—â–µ–Ω–∏—é
    formMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
    
    // –°–±—Ä–æ—Å —Ñ–æ—Ä–º—ã
    this.reset();
});
</script>
{% endblock %}
